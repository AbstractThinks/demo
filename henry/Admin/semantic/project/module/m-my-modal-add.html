
<link rel="import" href="../module/my-select-school.html" media="screen" title="no title">
<link rel="import" href="../module/my-select-subject.html" media="screen" title="no title">

<dom-module id="my-modal-add">
  <template >
      <div class="header">教师基本信息</div>
      <div class="content">
          <form id="add-staff-form" class="ui form add-staff-form">
              <div class="fields">
                  <div class="eight wide field">
                      <label>姓名</label>
                      <input class="username" type="text" placeholder="" name="username" >
                  </div>
                  <div class="eight wide field">
                      <label>编号</label>
                      <input class="staffNum" type="text" placeholder="" name="username">
                  </div>
              </div>
              <div class="fields">
                <my-select-school class="eight wide field my-select-school"></my-select-school>
                <my-select-subject class="eight wide field my-select-subject"></my-select-subject>
              </div>
          </form>
  </div>
      <div class="actions">
        <button class="ui button basic save medium" on-click="handleConfirm">&nbsp;&nbsp;<i class="add circle icon"></i> 确认 &nbsp;&nbsp;</button>
        <!-- <button class="ui button basic reset medium">&nbsp;&nbsp;<i class="minus square icon"></i>重置 &nbsp;&nbsp;</button> -->
        <button class="ui cancel button basic medium">&nbsp;&nbsp;<i class="remove circle icon"></i>取消 &nbsp;&nbsp;</button>
      </div>

  </template>
  <script type="text/javascript">
          Polymer({
                  is : "my-modal-add",
                  properties: {
                    staff: Object
                  },
                  handleConfirm: function () {
                    var that = this;
                    var username = $(".username").val();
                    var staffNum = $(".staffNum").val();
                    var schoolId = parseInt($('.my-select-school .item.active.selected').data('value'));
                    var teachingSubject = parseInt($('.my-select-subject .item.active.selected').data('value'));
                    $('.ui.modal').modal('hide');
                    $.ajax({
                        url:"http://k12.iyunbei.com/api/staff",
                        type: 'post',
                        data: {name:username,staffNum:staffNum,schoolId:schoolId,teachingSubject:teachingSubject},
                        dataType:"json",
                        cache: false,
                        success: function (data) {
                            if (data.error) {

                            } else {
                               $('#my-table').get(0).setAttribute("addData", JSON.stringify(data));
                               $('.ui.modal').modal('hide');
                            }
                        },
                        error: function (e) {
                            console.log(e)
                        }
                    });
                },
                ready: function () {


                }
          });

  </script>
</dom-module>
