<dom-module id="detailed-info">
  <template>
          <div class="ui column divided grid ">
                  <div class="row">
                          <div class="twelve wide column transition hidden">
                                <div class="row">
                                    <detailed-pdf></detailed-pdf>
                                </div>
                                  <div class="row" style="margin-top:24px;">
                                          <button class="ui basic button large fluid mt24" on-click="handleDownload">
                                                  <i class="icon download"></i>
                                                  下载
                                          </button>
                                  </div>
                                  <div class="row">
                                          <my-comments class="ui comments my-comments"></my-comments>
                                  </div>
                          </div>
                          <div class="four wide column transition hidden">
                                  <div class="ui card" style="margin-top:24px;">
                                          <div class="content">
                                                  <i class="right floated star icon"></i>

                                                  <div class="header">文件标题&nbsp;[[author.resourceName]]</div>
                                                  <div class="description">
                                                          <p>学科&nbsp;[[author.subjectId]]</p>
                                                          <p>年级&nbsp;[[author.gradeId]]</p>
                                                          <p>作者&nbsp;<a href="../other/other.html?[[author.userId]]">[[author.userId]]</a></p>
                                                          <p>时间&nbsp;[[author.createdTime]]</p>
                                                  </div>
                                          </div>
                                          <div class="extra content">
                                                  <span class="right floated star">
                                                  <i class="star icon" on-click="handleCollections"></i>
                                                  搜藏文章
                                                  </span>
                                          </div>
                                  </div>
                                  <!-- <button class="ui basic button large fluid">
                                  <i class="icon download"></i>
                                  下载
                                  </button> -->
                          </div>
                  </div>
          </div>
  </template>
  <script type="text/javascript">
          Polymer({
                  is : "detailed-info",
                  handleDownload : function () {
                    var that = this;
                    location.href = 'http://k12.iyunbei.com/api/resources/download/'+that.author.id;
                  },
                  handleCollections : function () {
                      var that = this;
                      $.ajax({
                              url:'http://k12.iyunbei.com/api/resources/favorite/'+ that.author.id,
                              type: 'post',
                              data: {resourceId: that.author.id},
                              success: function (data) {
                                  if (data.error) {

                                  } else {

                                  }
                              },
                              error: function (e) {
                                      console.log(e)
                              }
                      });
                  },
                  attributeChanged: function(attrName, oldVal, newVal) {
                     var that = this;
                     if (attrName == 'detailedid') {
                         $.ajax({
                                 url:'http://k12.iyunbei.com/api/resources/'+newVal,
                                 type: 'get',
                                 success: function (data) {
                                     if (data.error) {

                                     } else {
                                         console.log(data);
                                             that.author = data;
                                     }
                                 },
                                 error: function (e) {
                                         console.log(e)
                                 }
                         });

                     }
                  },
                  ready: function () {
                        //  var id = location.search.split("?")[1];


                  }
          });
  </script>
</dom-module>
