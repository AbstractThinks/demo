
<dom-module id="my-card">
    <style media="screen">
        .my-card > div.column > a{
            display: block;
        }
        .ui.move.reveal > .content {
            display: block!important;
            top: 0;
            bottom:0;
            /*padding: 8px;*/
        }
        .ui.move.reveal > .hidden.content div{
                height: 100%;
                width: 100%;
                padding: 1em;

        }
    </style>
  <template>
      <template is="dom-repeat" items="[[cards]]">
            <div class="column">
                <a href="../detailed/detailed.html?{{item.id}}">
                <div class="ui card">
                  <div class="image">
                    <img src="http://k12.iyunbei.com/download/img/preview/{{item.resourcePhysicalId}}.png" class="ui image" />
                  </div>
                  <div class="content">
                    <a class="header">{{item.resourceName}}</a>
                    <div class="meta">
                      <span class="date">
                        {{item.subjectName}}
                        {{filterClass(item.resourceTypeId)}}
                        {{item.gradeName}}
                      </span>
                    </div>
                    <div class="description">
                        {{item.staffName}} 
                    </div>
                  </div>
                  <div class="extra content">
                     <i class="users icon"></i>&nbsp;{{item.downloadCount}}人已下载
                     <span class="right floated">{{filterDate(item.createdTime)}}</span>
                  </div>
                </div>
                </a>
            </div>
      </template>
  </template>
  <script type="text/javascript">
          Polymer({
                  is : "my-card",
                  properties : {
                     pagesize: String,
                     page: String,
                     resourcetypeid: String
                    //  cards: Object
                  },
                  updateDatas : function (e) {
                      console.log(e);
                  },
                  filterDate : function (value) {
                     
                    var date = new Date(value);
                    var seperator1 = "-";
                    var seperator2 = ":";
                    var month = date.getMonth() + 1;
                    var strDate = date.getDate();
                    if (month >= 1 && month <= 9) {
                        month = "0" + month;
                    }
                    if (strDate >= 0 && strDate <= 9) {
                        strDate = "0" + strDate;
                    }
                    var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate
                            // + " " + date.getHours() + seperator2 + date.getMinutes()
                            // + seperator2 + date.getSeconds();
                    return currentdate;
                  },
                  attributeChanged: function(attrName, oldVal, newVal) {
                    var that = this;
                    console.log(attrName)
                    console.log(oldVal)
                    console.log(newVal)
                    if (attrName == 'urlreq') {
                        $.ajax({
                                url: newVal,
                                type: 'get',
                                success: function (data) {
                                        if (data.error) {

                                        } else {
                                          console.log(data)
                                                that.cards = data.entries;
                                        }
                                },
                                error: function (e) {
                                        console.log(e)
                                }
                        });
                    }

                  },
                  filterClass: function (e) {
                    switch (e){
                      case 1:
                        return "试卷";
                      case 2:
                        return "课件";
                      case 3:
                        return "视频";
                      case 4:
                        return "教学资料";
                      default:
                        return "";
                    }

                  },
                  ready : function() {
                        // //  let pagesize = this.pagesize;
                        // //  let page = this.page;
                        // //  let resourcetypeid = this.resourcetypeid;
                        // // $.ajax({
                        // //         url:'http://k12.iyunbei.com/api/resources/resource/'+resourcetypeid+'/'+page+'/'+pageSize,
                        // //         type: 'get',
                        // //         success: function (data) {
                        // //                 if (data.error) {
                        // //
                        // //                 } else {
                        // //                         this.cards = data;
                        // //                 }
                        // //         },
                        // //         error: function (e) {
                        // //                 console.log(e)
                        // //         }
                        // // });
                        // this.cards = [
                        //         {"id":"1","img":"../../img/card.png", "description":"40道选择题，80道应用题,  知识点全面，为你的基础打下坚实的基础","title":"高一基础复习试卷","date":"创建于2014","num":"2","author":"张三","subject":"语文","grade":"高一"},
                        //         {"img":"../../img/card.png", "description":"40道选择题，80道应用题， 知识点全面，为你的基础打下坚实的基础","title":"高一基础复习试卷","date":"创建于2014","num":"2"},
                        //         {"img":"../../img/card.png", "description":"40道选择题，80道应用题， 知识点全面，为你的基础打下坚实的基础","title":"高一基础复习试卷","date":"创建于2014","num":"2"},
                        //         {"img":"../../img/card.png", "description":"40道选择题，80道应用题， 知识点全面，为你的基础打下坚实的基础","title":"高一基础复习试卷","date":"创建于2014","num":"2"},
                        //         {"img":"../../img/card.png", "description":"40道选择题，80道应用题， 知识点全面，为你的基础打下坚实的基础","title":"高一基础复习试卷","date":"创建于2014","num":"2"}
                        // ]
                  }
          });
  </script>
</dom-module>
