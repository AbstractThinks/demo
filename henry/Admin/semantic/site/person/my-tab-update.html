<dom-module id="my-tab-update">
  <template >
          <content></content>
          <form class="ui form">
                  <div class="ui internally celled grid">
                          <div class="row">
                                  <div class="sixteen wide column">
                                          

                                          <div class="field row">
                                                  <!-- <div class="field">
                                                          <label>类别</label>
                                                          <select class="ui class dropdown">
                                                                  <option value="">类别</option>
                                                                  <option value="1">视频</option>
                                                                  <option value="3">课件</option>
                                                                  <option value="3">试卷</option>
                                                                  <option value="3">资料</option>
                                                          </select>

                                                  </div> -->
                                                  <select-module class="field select-resource-update" url="http://k12.iyunbei.com/api/resources/listAllResourceTypes}" label="资源类型"></select-module>
                                          </div>
                                          <div class="field row">
                                                  <!-- <div class="field">
                                                          <label>科目</label>
                                                          <select class="ui subject dropdown">
                                                                  <option value="">科目</option>
                                                                  <option value="1">语文</option>
                                                                  <option value="2">数学</option>
                                                                  <option value="5">英语</option>
                                                          </select>
                                                  </div> -->

                                                  <select-module class="field select-subject-update" url="http://k12.iyunbei.com/api/subjects?page=1" label="学科"></select-module>
                                          </div>
                                          <div class="field row">
                                                  <div class="field">
                                                          <!-- <label>年级</label>
                                                          <select class="ui grade dropdown">
                                                                  <option value="">年级</option>
                                                                  <option value="1">高一</option>
                                                                  <option value="2">高二</option>
                                                                  <option value="3">高三</option>
                                                          </select> -->
                                                          <select-module class="field select-resource-update" url="http://k12.iyunbei.com/api/dynamicenum/1028" label="年级"></select-module>
                                                  </div>
                                          </div>

                                          <div class="field row">
                                                  <label>描述</label>
                                                  <textarea id="desc" name="desc"></textarea>
                                          </div>
                                          <div class="field row">
                                                  <div id="file-upload"></div>
                                          </div>
                                          <div class="ui large buttons">
                                                  <a class="ui button" on-click="handleSaveData">保存</a>
                                                  <div class="or teal"></div>
                                                  <a class="ui button">重置</a>
                                          </div>
                                  </div>
                          </div>
                  </div>
          </form>
  </template>
  <script type="text/javascript">
          Polymer({
                  is : "my-tab-update",
                  handleSaveData: function (e) {
                     // $('.Prompt.modal').modal('show')
                     // return;
                     $('.pusher').dimmer('show');
                      var data = {};
                      data.fileId = $("#uploadedWork").attr('fileId');
                      data.resourceTypeId =$('.field.select-resource-update .selection.dropdown .item.active.selected').data('value');
                      data.subjectId = $('.field.select-subject-update .selection.dropdown .item.active.selected').data('value');
                      data.gradeId = $('.ui.grade.dropdown .item.active.selected').data('value');
                      data.resourceName = $("#uploadedWork").val().substring( $("#uploadedWork").val().lastIndexOf('\\')+1 );
                      data.desc = $('#desc').val();
                      $.ajax({
                          url:"http://k12.iyunbei.com/api/resources/resourceUpload",
                          type: 'post',
                          data: data,
                          dataType:"json",
                          cache: false,
                          success: function (data) {
                            $('.pusher').dimmer('hide');
                              if (data.error) {
                                
                              } else {
                                // $('.pusher').dimmer('hide');
                                 console.log(data)
                                 $('my-tab-common-list.resources').get(0).setAttribute("reqdata", JSON.stringify({name:"resources",id:$('my-tab-info').attr("userid"),requrl:'http://k12.iyunbei.com/api/resources/user/',count:Math.random()}));
                                 $('.tooltip.modal').modal('show');

                              }
                          },
                          error: function (e) {
                            $('.pusher').dimmer('hide');
                              console.log(e)
                          }
                      });
                  },
                  ready : function () {
                       console.log("person-update")
                  }
          });
  </script>
</dom-module>
